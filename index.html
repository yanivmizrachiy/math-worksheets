<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>×“×£ ×¢×‘×•×“×” - ××§×‘×™×œ×™×•×ª ×‘××¢×¨×›×ª ×”×¦×™×¨×™×</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- PDF LIBRARIES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
  body { font-family: Arial, sans-serif; margin:20px; background:#f0f4ff; color:#111; line-height:1.6; }
  h1, h2 { text-align:center; }
  .section { background: #fff; padding:20px; margin:24px 0; border-radius:12px; border:1px solid #d6d9df; box-shadow:0 6px 18px rgba(20,30,60,0.06); }
  .question { background:#eef2ff; padding:14px; border-radius:10px; margin-bottom:18px; border-right:5px solid #4a57ff; }
  .coordinates { font-weight:700; display:block; margin-bottom:8px; }
  .sub-question { margin-top:8px; }
  canvas { display:block; margin:12px auto; width:560px; height:420px; background:#fff; border:1px solid #d6d9df; border-radius:10px; }
  @media (max-width:640px){ canvas{width:320px;height:240px;} }

  #pdfButton {
    padding:12px 20px;
    background:#4a57ff;
    color:white;
    font-size:16px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    display:block;
    margin:20px auto;
  }
</style>
</head>
<body>

<!-- PDF BUTTON -->
<button id="pdfButton" onclick="downloadPDF()">ğŸ“„ ×”×•×¨×“ ×›-PDF (2 ×©××œ×•×ª ×‘×¢××•×“)</button>

<h1>×“×£ ×¢×‘×•×“×” - ××§×‘×™×œ×™×•×ª ×‘××¢×¨×›×ª ×”×¦×™×¨×™×</h1>

<div class="section">
  <h2>×©××œ×•×ª ×’×™××•××˜×¨×™×” ×× ×œ×™×˜×™×ª (×›×™×ª×” ×˜)</h2>

  <!-- Q1 -->
  <div class="question">
    <div class="coordinates">1. ×§×“×§×•×“×™× ×©×œ ××§×‘×™×œ×™×ª ×”×: \(A(-5,2)\), \(B(-3,6)\), \(D(1,2)\).</div>
    <div class="sub-question">×. ××¦××• ××ª ×©×™×¢×•×¨×™ ×”×§×“×§×•×“ \(C\).</div>
    <div class="sub-question">×‘. ××¦××• ××ª ××©×•×•××” ×©×œ ×”×™×©×¨ ×¢×œ×™×• ××•× ×— ×”××œ×›×¡×•×Ÿ \(BD\).</div>
    <div class="sub-question">×’. ×”×¢×‘×™×¨×• ××ª \(A\) ×œ×¨××©×™×ª ×•×”×¦×œ×¢ \(AD\) ×¢×œ ×¦×™×¨ ×”-x. ××”× ×©×™×¢×•×¨×™ ×”×§×“×§×•×“×™× ×”××—×¨×™×?</div>
    <canvas id="chart1" width="560" height="420"></canvas>
  </div>

  <!-- Q2 -->
  <div class="question">
    <div class="coordinates">2. ×©×œ×•×©×” ×§×“×§×•×“×™× ×©×œ ××§×‘×™×œ×™×ª ×”×: \(A(1,3)\), \(B(-6,3)\), \(C(-2,0)\).</div>
    <div class="sub-question">×. ××¦××• ××ª \(D\).</div>
    <div class="sub-question">×‘. ××”×• \(E\) (×’×•×‘×” ×-A ×œ-CD)?</div>
    <div class="sub-question">×’. ××” ××•×¨×š \(AE\)?</div>
    <div class="sub-question">×“. ×—×©×‘×• ××ª ×©×˜×— ×”××§×‘×™×œ×™×ª.</div>
    <div class="sub-question">×”. ×—×©×‘×• ××ª ×”×™×§×£ ×”××§×‘×™×œ×™×ª.</div>
    <canvas id="chart2" width="560" height="420"></canvas>
  </div>

  <!-- Q3 -->
  <div class="question">
    <div class="coordinates">3. ×”×¦×œ×¢ \(AB\) ××•× ×—×ª ×¢×œ ×¦×™×¨ ×”-x, ×”×¦×œ×¢ \(AD\) ×¢×œ ×”×™×©×¨ \(y=x\) ×•×”×§×“×§×•×“ \(C(7,3)\).</div>
    <div class="sub-question">×. ××¦××• ××ª ×©×™×¢×•×¨×™ ×”×§×“×§×•×“ \(A\).</div>
    <div class="sub-question">×‘. ×¢×œ ××™×–×” ×™×©×¨ ××•× ×—×ª \(CD\)?</div>
    <div class="sub-question">×’. ×¢×œ ××™×–×” ×™×©×¨ ××•× ×—×ª \(BC\)?</div>
    <div class="sub-question">×“. ××” ×©×˜×— ×”××§×‘×™×œ×™×ª?</div>
    <canvas id="chart3" width="560" height="420"></canvas>
  </div>

  <!-- Q4 -->
  <div class="question">
    <div class="coordinates">4. \(A(-2,3)\), \(B(-2,7)\), \(C(0,5)\), \(D(0,1)\).</div>
    <div class="sub-question">×. ×”×× ×”× ×ª×•× ×™× ×××¤×©×¨×™× ×œ××¦×•× ××ª ×”×™×§×£ ×”××§×‘×™×œ×™×ª?</div>
    <div class="sub-question">×‘. ×”×× ×”× ×ª×•× ×™× ×××¤×©×¨×™× ×œ××¦×•× ××ª ×©×˜×— ×”××§×‘×™×œ×™×ª?</div>
    <canvas id="chart4" width="560" height="420"></canvas>
  </div>

  <!-- Q5 -->
  <div class="question">
    <div class="coordinates">5. \(AB\) ×¢×œ \(y=3x+4\), \(BC\) ×¢×œ \(y=x+2\), ×•-\(D(1,-1)\).</div>
    <div class="sub-question">×. ××¦××• ××ª \(B\).</div>
    <div class="sub-question">×‘. ××¦××• ××©×•×•××•×ª ×”×™×©×¨×™× \(DC\) ×•-\(AD\).</div>
    <div class="sub-question">×’. ××¦××• ××ª ××©×•×•××ª ×”××œ×›×¡×•×Ÿ \(AC\).</div>
    <canvas id="chart5" width="560" height="420"></canvas>
  </div>

  <!-- Q6 -->
  <div class="question">
    <div class="coordinates">6. \(D(4,4)\), \(C(4,10)\). \(BC\) ×¢×œ \(y=\frac12 x+8\). ×”××œ×›×¡×•×Ÿ \(BD\) ×¢×œ \(y=8-x\).</div>
    <div class="sub-question">×. ××¦××• ××ª \(A\).</div>
    <div class="sub-question">×‘. ××¦××• ××©×•×•××•×ª ×”×¦×œ×¢×•×ª.</div>
    <div class="sub-question">×’. ××¦××• ××ª \(B\).</div>
    <div class="sub-question">×“. ××”×• ××•×¨×š ×”×’×•×‘×”?</div>
    <div class="sub-question">×”. ×”×•×›×™×—×• ×“××™×•×Ÿ ××©×•×œ×©×™×.</div>
    <canvas id="chart6" width="560" height="420"></canvas>
  </div>

</div>

<!-- â­ FINAL FIXED PDF EXPORTER (2 questions per page, NO CLIPPING) -->
<script>
async function downloadPDF() {
    const { jsPDF } = window.jspdf;

    const questions = Array.from(document.querySelectorAll(".question"));

    // group questions into chunks of 2
    const groups = [];
    for (let i=0; i < questions.length; i += 2) {
        const pair = [questions[i]];
        if (questions[i+1]) pair.push(questions[i+1]);
        groups.push(pair);
    }

    const pdf = new jsPDF("p", "mm", "a4");
    const pdfW = 210;
    const pdfH = 297;

    for (let g = 0; g < groups.length; g++) {

        // create clean render container
        const temp = document.createElement("div");
        temp.style.direction = "rtl";
        temp.style.width = "900px";
        temp.style.padding = "40px";
        temp.style.background = "#f0f4ff";
        temp.style.boxSizing = "border-box";
        temp.style.position = "fixed";
        temp.style.left = "-2000px";
        temp.style.top = "0";
        document.body.appendChild(temp);

        // clone the 2 questions
        for (const el of groups[g]) {
            const clone = el.cloneNode(true);

            // fix canvas by converting chart canvases to images
            const origCanvas = el.querySelector("canvas");
            if (origCanvas) {
                try {
                    const imgURL = origCanvas.toDataURL("image/png");
                    const img = document.createElement("img");
                    img.src = imgURL;
                    img.style.width = "560px";
                    img.style.height = "420px";
                    clone.querySelector("canvas").replaceWith(img);
                } catch {}
            }

            clone.style.marginBottom = "40px";
            temp.appendChild(clone);
        }

        // render group â†’ canvas
        const canvas = await html2canvas(temp, {
            scale: 2,
            useCORS: true,
            backgroundColor: null
        });

        document.body.removeChild(temp);

        const imgW = pdfW;
        const imgH = (canvas.height * pdfW) / canvas.width;

        // auto-scale if too tall
        let finalW = imgW;
        let finalH = imgH;

        if (finalH > pdfH - 10) {
            const scale = (pdfH - 10) / finalH;
            finalW *= scale;
            finalH *= scale;
        }

        if (g > 0) pdf.addPage();

        const yOffset = (pdfH - finalH) / 2;

        pdf.addImage(canvas.toDataURL("image/png"), "PNG", 0, yOffset, finalW, finalH);
    }

    pdf.save("worksheet.pdf");
}
</script>

<!-- DRAWING CODE (unchanged) -->
<script>
function lineBounds(points){const xs=points.map(p=>p[0]),ys=points.map(p=>p[1]);return{minX:Math.min(...xs)-2,maxX:Math.max(...xs)+2,minY:Math.min(...ys)-2,maxY:Math.max(...ys)+2};}
function labelPlugin(labels){return{id:'pointLabels',afterDraw(chart){const ctx=chart.ctx;ctx.save();ctx.font='bold 12px Arial';ctx.fillStyle='#0b1220';labels.forEach(pt=>{const xp=chart.scales.x.getPixelForValue(pt.x),yp=chart.scales.y.getPixelForValue(pt.y);const off=8*(pt.side==='rtl'?-1:1);ctx.fillText(pt.label,xp+off,yp-8);});ctx.restore();}};}

function drawPlane(canvasId,vertices){
  const coords=vertices.map(v=>[v.x,v.y]);
  const b=lineBounds(coords);
  const xmin=b.minX,xmax=b.maxX,ymin=b.minY,ymax=b.maxY;
  const axisX=[{x:xmin,y:0},{x:xmax,y:0}];
  const axisY=[{x:0,y:ymin},{x:0,y:ymax}];
  const closed=coords.concat([coords[0]]);
  const ctx=document.getElementById(canvasId).getContext('2d');
  if(ctx.chartInstance)ctx.chartInstance.destroy();
  const labels=vertices.map(v=>({x:v.x,y:v.y,label:v.label,side:v.side||'ltr'}));

  const chart=new Chart(ctx,{
    type:'scatter',
    data:{datasets:[
      {data:axisX,showLine:true,borderColor:'#999',pointRadius:0,borderWidth:1},
      {data:axisY,showLine:true,borderColor:'#999',pointRadius:0,borderWidth:1},
      {data:closed.map(p=>({x:p[0],y:p[1]})),showLine:true,fill:true,
       borderColor:'#246bff',backgroundColor:'rgba(36,107,255,0.18)',
       pointRadius:4,borderWidth:2},
      {data:coords.map(p=>({x:p[0],y:p[1]})),showLine:false,
       pointRadius:5,backgroundColor:'#0047b3'}
    ]},
    options:{
      responsive:false,
      maintainAspectRatio:false,
      scales:{
        x:{min:xmin,max:xmax,grid:{color:'#e6e6e6'}},
        y:{min:ymin,max:ymax,grid:{color:'#e6e6e6'}}
      },
      plugins:{legend:{display:false}}
    },
    plugins:[labelPlugin(labels)]
  });
  ctx.chartInstance=chart;
}

/* Vertices */
const Q1_A={x:-5,y:2,label:'A'},Q1_B={x:-3,y:6,label:'B'},Q1_D={x:1,y:2,label:'D'};
const Q1_C={x:Q1_B.x+(Q1_D.x-Q1_A.x),y:Q1_B.y+(Q1_D.y-Q1_A.y),label:'C'};

const Q2_A={x:1,y:3,label:'A'},Q2_B={x:-6,y:3,label:'B'},Q2_C={x:-2,y:0,label:'C'};
const Q2_D={x:Q2_C.x+(Q2_A.x-Q2_B.x),y:Q2_C.y+(Q2_A.y-Q2_B.y),label:'D'};

const Q3_A={x:0,y:0,label:'A'},Q3_B={x:4,y:0,label:'B'},Q3_D={x:3,y:3,label:'D'},Q3_C={x:7,y:3,label:'C'};

const Q4_A={x:-2,y:3,label:'A'},Q4_B={x:-2,y:7,label:'B'},Q4_C={x:0,y:5,label:'C'},Q4_D={x:0,y:1,label:'D'};

const Q5_A={x:-3,y:-5,label:'A'},Q5_B={x:-1,y:1,label:'B'},Q5_C={x:3,y:5,label:'C'},Q5_D={x:1,y:-1,label:'D'};

const Q6_D={x:4,y:4,label:'D'},Q6_C={x:4,y:10,label:'C'};
const Q6_B={x:0,y:8,label:'B'},Q6_A={x:0,y:2,label:'A'};

Q1_A.side='rtl';Q1_B.side='rtl';Q1_C.side='ltr';Q1_D.side='ltr';
Q2_A.side='rtl';Q2_B.side='rtl';Q2_C.side='ltr';Q2_D.side='ltr';
Q3_A.side='rtl';Q3_B.side='rtl';Q3_C.side='ltr';Q3_D.side='ltr';
Q4_A.side='rtl';Q4_B.side='rtl';Q4_C.side='ltr';Q4_D.side='ltr';
Q5_A.side='rtl';Q5_B.side='rtl';Q5_C.side='ltr';Q5_D.side='ltr';
Q6_A.side='rtl';Q6_B.side='rtl';Q6_C.side='ltr';Q6_D.side='ltr';

window.addEventListener('load',()=>{
  drawPlane('chart1',[Q1_A,Q1_B,Q1_C,Q1_D]);
  drawPlane('chart2',[Q2_A,Q2_B,Q2_C,Q2_D]);
  drawPlane('chart3',[Q3_A,Q3_B,Q3_C,Q3_D]);
  drawPlane('chart4',[Q4_A,Q4_B,Q4_C,Q4_D]);
  drawPlane('chart5',[Q5_A,Q5_B,Q5_C,Q5_D]);
  drawPlane('chart6',[Q6_A,Q6_B,Q6_C,Q6_D]);
});
</script>

</body>
</html>
